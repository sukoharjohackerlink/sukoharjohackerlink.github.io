<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Meta4Sec 2025‚Äì Crypto" />
<meta property="og:locale" content="en" />
<meta name="description" content="Welcome to my small ctf‚Äôs and related to technolgy writeups blog" />
<meta property="og:description" content="Welcome to my small ctf‚Äôs and related to technolgy writeups blog" />
<link rel="canonical" href="http://localhost:4000/posts/Meta4Sec-2025/" />
<meta property="og:url" content="http://localhost:4000/posts/Meta4Sec-2025/" />
<meta property="og:site_name" content="r‚Äôs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-02T00:00:00+07:00" />
<meta property="og:image" content="http://localhost:4000/assets/img/avatar.jpg" /><meta name="twitter:card" content="summary_large_image" />
      <meta property="twitter:image" content="http://localhost:4000/assets/img/avatar.jpg" />
<meta property="twitter:title" content="Meta4Sec 2025‚Äì Crypto" />
<meta name="twitter:site" content="@rafidghanim" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-08T17:44:41+07:00","datePublished":"2025-08-02T00:00:00+07:00","description":"Welcome to my small ctf‚Äôs and related to technolgy writeups blog","headline":"Meta4Sec 2025‚Äì Crypto","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Meta4Sec-2025/"},"url":"http://localhost:4000/posts/Meta4Sec-2025/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Meta4Sec 2025‚Äì Crypto | r's
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="r's">
<meta name="application-name" content="r's">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">r's</a>
    <p class="site-subtitle fst-italic mb-0">CTF and Security analysis blog</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/rafidghanim"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/rafidghanim"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['rafidghanim022','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Meta4Sec 2025‚Äì Crypto</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Meta4Sec 2025‚Äì Crypto</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1754067600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug  2, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1754649881"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug  8, 2025
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/rafidghanim">rafidghanim</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1647 words"
>
  <em>9 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Meta4Sec 2025‚Äì Crypto</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Meta4Sec 2025‚Äì Crypto</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p align="left"> <a href="/assets/img/meta4sec.jpeg" class="popup img-link shimmer"><img src="/assets/img/meta4sec.jpeg" alt="logo" width="300" loading="lazy"></a></p>

<h1 id="meta4sec-2025--crypto-writeup">Meta4Sec 2025 ‚Äì Crypto Writeup</h1>

<blockquote>
  <p>Writeup from the <strong>Meta4Sec CTF</strong> Cryptography challenge that I‚Äôve worked on</p>
</blockquote>

<p>Thank you for taking the time and effort to solve the cryptography challenge I created. I truly appreciate the thought, strategies, and dedication you put into working through it. I hope this challenge provided you with valuable experience and insight into the world of cryptography. üíªüîê</p>

<hr />

<h2 id="-crypto"><span class="me-2">üîê Crypto</span><a href="#-crypto" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="-challenge-0"><span class="me-2">üîπ Challenge: 0</span><a href="#-challenge-0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li><strong>Description</strong>: -</li>
  <li><strong>Attachments</strong>: <a href="/assets/files/meta4sec/chall_0.zip">chall_0.zip</a></li>
  <li><strong>Solution Steps</strong>:</li>
</ul>

<h4 id="-challenge-overview"><span class="me-2">üß© Challenge Overview</span><a href="#-challenge-overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>We are provided with a zip archive. After extracting it, we get the following files:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>flag.txt  output_test.txt  readme.md  test.txt
</pre></td></tr></tbody></table></code></div></div>

<h5 id="-readmemd"><span class="me-2">üìÑ readme.md</span><a href="#-readmemd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>

<div class="language-md highlighter-rouge"><div class="code-header">
        <span data-label-text="Markdown"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>A mysterious message has been intercepted, and according to analysts, it appears to be encrypted with an unusual twist on a traditional cipher.

Luckily, we have a sample of both the plaintext and its corresponding ciphertext, which seems to be encrypted using the same method as the flag.

Your task is to:
<span class="p">1.</span> Identify the encryption pattern by comparing the known plaintext and ciphertext.
<span class="p">2.</span> Use this pattern to decrypt the flag in <span class="sb">`flag.txt`</span>.

===[ Files ]===
<span class="p">
-</span> test.txt            # known plaintext
<span class="p">-</span> output_test.txt     # corresponding ciphertext
<span class="p">-</span> flag.txt            # encrypted flag

===[ Objective ]===

Retrieve the original flag from <span class="sb">`flag.txt`</span>.

Flag format: <span class="sb">`Meta4Sec{...}`</span>

Brute-forcing isn't required to solve this, but you‚Äôre welcome to try. A logical approach and familiarity with classic ciphers will be more effective.

Good luck!
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h4 id="-task-summary"><span class="me-2">üéØ Task Summary</span><a href="#-task-summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Based on the information in <code class="language-plaintext highlighter-rouge">readme.md</code>, the main objective is to analyze the encryption used in <code class="language-plaintext highlighter-rouge">test.txt</code> and <code class="language-plaintext highlighter-rouge">output_test.txt</code>, and then apply the same logic to decrypt <code class="language-plaintext highlighter-rouge">flag.txt</code>.</p>

<hr />

<h4 id="-sample-analysis"><span class="me-2">üîç Sample Analysis</span><a href="#-sample-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<h5 id="from-output_testtxt"><span class="me-2">From <code class="language-plaintext highlighter-rouge">output_test.txt</code>:</span><a href="#from-output_testtxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Sheajra Shaal suat bkeunt einskpri taeurt dmaal sheajra dna mhais saendaehr ahdaal einskpri mneankgagnu aalmgtoir
</pre></td></tr></tbody></table></code></div></div>

<h5 id="from-testtxt"><span class="me-2">From <code class="language-plaintext highlighter-rouge">test.txt</code>:</span><a href="#from-testtxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>Sejarah Salah satu bentuk enkripsi tertua dalam sejarah dan masih sederhana adalah enkripsi menggunakan algoritma
</pre></td></tr></tbody></table></code></div></div>

<p>Let‚Äôs examine the encryption of the word <code class="language-plaintext highlighter-rouge">Sejarah</code> ~&gt; <code class="language-plaintext highlighter-rouge">Sheajra</code>.</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Index</th>
      <th>Original</th>
      <th>Encrypted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>S</td>
      <td>S</td>
    </tr>
    <tr>
      <td>1</td>
      <td>e</td>
      <td>h</td>
    </tr>
    <tr>
      <td>2</td>
      <td>j</td>
      <td>e</td>
    </tr>
    <tr>
      <td>3</td>
      <td>a</td>
      <td>a</td>
    </tr>
    <tr>
      <td>4</td>
      <td>r</td>
      <td>j</td>
    </tr>
    <tr>
      <td>5</td>
      <td>a</td>
      <td>r</td>
    </tr>
    <tr>
      <td>6</td>
      <td>h</td>
      <td>a</td>
    </tr>
  </tbody>
</table></div>

<p>We observe the following transformation:</p>
<ul>
  <li>index[0] stays the same ~&gt; <code class="language-plaintext highlighter-rouge">S</code></li>
  <li>index[1] becomes index[6]</li>
  <li>index[2] becomes index[1]</li>
  <li>index[3] becomes index[5]</li>
  <li>index[4] becomes index[2]</li>
  <li>index[5] becomes index[4]</li>
  <li>index[6] becomes index[3]</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">bentuk</code> ~&gt; <code class="language-plaintext highlighter-rouge">bkeunt</code></p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Index</th>
      <th>Original</th>
      <th>Encrypted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>b</td>
      <td>b</td>
    </tr>
    <tr>
      <td>1</td>
      <td>e</td>
      <td>k</td>
    </tr>
    <tr>
      <td>2</td>
      <td>n</td>
      <td>e</td>
    </tr>
    <tr>
      <td>3</td>
      <td>t</td>
      <td>u</td>
    </tr>
    <tr>
      <td>4</td>
      <td>u</td>
      <td>n</td>
    </tr>
    <tr>
      <td>5</td>
      <td>k</td>
      <td>t</td>
    </tr>
  </tbody>
</table></div>

<ul>
  <li>index[0] stays the same ‚Üí <code class="language-plaintext highlighter-rouge">b</code></li>
  <li>index[1] becomes index[5]</li>
  <li>index[2] becomes index[1]</li>
  <li>index[3] becomes index[5]</li>
  <li>index[4] becomes index[2]</li>
  <li>index[5] becomes index[4]</li>
</ul>

<p>This suggests a fixed permutation pattern
This insight gives us a solid base to reverse the process and decrypt the flag.</p>

<blockquote>
  <p>solver.py</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre> <span class="nf">encode</span><span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>
    <span class="k">return</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="n">s</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="sh">''</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">right</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">result</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">result</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="n">left</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">right</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">return</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>


<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">flag.txt</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">().</span><span class="nf">split</span><span class="p">()</span>
<span class="n">decrypted</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">enc</span><span class="p">:</span>
    <span class="n">decrypted</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">decode</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">decrypted</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><strong>Flag</strong>: <code class="language-plaintext highlighter-rouge">Meta4Sec{sajjjaddddkunnnn_absoluteeee_cineemaaaaaa_202cb962ac}</code></li>
</ul>

<hr />

<h3 id="-challenge-1"><span class="me-2">üîπ Challenge: 1</span><a href="#-challenge-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li><strong>Description</strong>: -</li>
  <li><strong>Attachments</strong>:  <a href="/assets/files/meta4sec/chall.zip">chall_zip</a></li>
  <li><strong>Solution Steps</strong>:</li>
</ul>

<h4 id="-overview"><span class="me-2">üîê Overview</span><a href="#-overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>This challenge script implements RSA encryption using a custom large-prime generation method. The encryption process introduces several cryptographic weaknesses that make the ciphertext recoverable.</p>

<hr />

<h4 id="-prime-generation-logic"><span class="me-2">üß™ Prime Generation Logic</span><a href="#-prime-generation-logic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">generate_large_prime_product</span><span class="p">():</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">primes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">primes</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">*=</span> <span class="n">p</span>
        <span class="n">phi</span> <span class="o">*=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">.</span><span class="nf">bit_length</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">8192</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nf">nextprime</span><span class="p">(</span><span class="nf">nextprime</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">primes</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">p</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>This function generates multiple <strong>512-bit primes</strong> and multiplies them until the result (<code class="language-plaintext highlighter-rouge">n</code>) is at least <strong>8192 bits</strong> long.</li>
  <li>The primes are generated using <code class="language-plaintext highlighter-rouge">nextprime(nextprime(p))</code>, meaning each new prime is <strong>very close</strong> to the previous one.</li>
  <li>Because these primes are closely spaced, the modulus <code class="language-plaintext highlighter-rouge">n</code> becomes vulnerable to <strong>root-based factorization techniques</strong> and then go back into previous prime until the result of  gcd prime and N less than 512 bit length.</li>
</ul>

<hr />

<h4 id="-rsa-key-generation-logic"><span class="me-2">üß¨ RSA Key Generation Logic</span><a href="#-rsa-key-generation-logic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_valid_prime_update</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">nextprime</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_rsa_keys</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">65537</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="nf">getPrime</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nf">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    <span class="n">private_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">.</span><span class="nf">construct</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
    <span class="n">public_key</span> <span class="o">=</span> <span class="n">private_key</span><span class="p">.</span><span class="nf">publickey</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">private_key</span><span class="p">,</span> <span class="n">public_key</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>After the initial modulus is constructed, the program updates the prime using <code class="language-plaintext highlighter-rouge">nextprime(n)</code> and treats this as the new <code class="language-plaintext highlighter-rouge">p</code>.</li>
  <li>A new small prime <code class="language-plaintext highlighter-rouge">q</code> is generated using <code class="language-plaintext highlighter-rouge">getPrime(16)</code>, which results in a <strong>16-bit</strong> value.</li>
  <li>Because <code class="language-plaintext highlighter-rouge">q</code> is so small, it can be <strong>brute-forced easily</strong> by trying all values in the range [1, 65536].</li>
</ul>

<hr />

<h4 id="Ô∏è-vulnerability-summary"><span class="me-2">‚ö†Ô∏è Vulnerability Summary</span><a href="#Ô∏è-vulnerability-summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>The first modulus <code class="language-plaintext highlighter-rouge">n</code> is built from many closely spaced 512-bit primes. These can be <strong>factored</strong> using numerical root techniques since the primes are near each other.</li>
  <li>The updated prime <code class="language-plaintext highlighter-rouge">p</code> is just <code class="language-plaintext highlighter-rouge">nextprime(n)</code>, which is <strong>predictable</strong>.</li>
  <li>The second prime <code class="language-plaintext highlighter-rouge">q</code> is only 16 bits, making it <strong>trivial to brute-force</strong>.</li>
  <li>These combined weaknesses make it possible to reconstruct the <strong>private RSA key</strong> and recover the plaintext from <code class="language-plaintext highlighter-rouge">public.pem</code> and the encrypted file.</li>
</ul>

<hr />

<h4 id="-exploitation-strategy"><span class="me-2">üß© Exploitation Strategy</span><a href="#-exploitation-strategy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ol>
  <li>Factor the initial 8192-bit modulus using numerical methods that exploit closely spaced primes.</li>
  <li>Compute <code class="language-plaintext highlighter-rouge">p = nextprime(n)</code> as used in the second phase.</li>
  <li>Brute-force all possible 16-bit <code class="language-plaintext highlighter-rouge">q</code> values (‚â§ 65536) to find the correct one.</li>
  <li>Rebuild the full private key using <code class="language-plaintext highlighter-rouge">p</code> and <code class="language-plaintext highlighter-rouge">q</code>.</li>
  <li>Decrypt the encrypted chunks and recover the original ciphertext.</li>
</ol>

<hr />

<h4 id="-solver"><span class="me-2">üìú Solver</span><a href="#-solver" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
</pre></td><td class="rouge-code"><pre><span class="c1"># === IMPORTS ===
</span><span class="kn">import</span> <span class="n">base64</span>
<span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="n">math</span> <span class="kn">import</span> <span class="n">gcd</span>

<span class="kn">from</span> <span class="n">sympy</span> <span class="kn">import</span> <span class="n">nextprime</span>
<span class="kn">from</span> <span class="n">gmpy2</span> <span class="kn">import</span> <span class="n">iroot</span>
<span class="kn">from</span> <span class="n">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>
<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">PKCS1_OAEP</span>
<span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">getPrime</span><span class="p">,</span> <span class="n">inverse</span><span class="p">,</span> <span class="n">bytes_to_long</span><span class="p">,</span> <span class="n">long_to_bytes</span><span class="p">,</span> <span class="n">isPrime</span>
<span class="p">)</span>

<span class="c1"># === HELPER FUNCTIONS ===
</span>
<span class="k">def</span> <span class="nf">prevprime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Find previous prime before n.</span><span class="sh">"""</span>
    <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="nf">isPrime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">n</span>
        <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="bp">None</span>  <span class="c1"># Shouldn't happen for n &gt; 2
</span>
<span class="k">def</span> <span class="nf">generate_large_prime_product</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n_candidate</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">65537</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Generate RSA modulus and private exponent from base prime `p`.</span><span class="sh">"""</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">primes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">primes</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">*=</span> <span class="n">p</span>
        <span class="n">phi</span> <span class="o">*=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">.</span><span class="nf">bit_length</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">8192</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nf">nextprime</span><span class="p">(</span><span class="nf">nextprime</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_candidate</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nf">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span>

    <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">encrypted</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">65537</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Decrypt ciphertext using reconstructed RSA private key.</span><span class="sh">"""</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nf">inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>

    <span class="n">private_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">.</span><span class="nf">construct</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
    <span class="n">public_key</span> <span class="o">=</span> <span class="n">private_key</span><span class="p">.</span><span class="nf">publickey</span><span class="p">()</span>

    <span class="n">cipher_decrypt</span> <span class="o">=</span> <span class="n">PKCS1_OAEP</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>

    <span class="n">key_size</span> <span class="o">=</span> <span class="n">public_key</span><span class="p">.</span><span class="nf">size_in_bytes</span><span class="p">()</span>
    <span class="n">chunk_size</span> <span class="o">=</span> <span class="n">key_size</span>  <span class="c1"># ciphertext chunk size
</span>
    <span class="n">decrypted_data</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">encrypted</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">):</span>
        <span class="n">chunk</span> <span class="o">=</span> <span class="n">encrypted</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span>
        <span class="n">decrypted_data</span> <span class="o">+=</span> <span class="n">cipher_decrypt</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">decrypted_data</span>

<span class="k">def</span> <span class="nf">find_factor_1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Brute-force factor using small values.</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">32767</span><span class="p">,</span> <span class="mi">65537</span><span class="p">):</span>
        <span class="k">if</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3000</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">x</span> <span class="o">//</span> <span class="n">i</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span>

<span class="c1"># === MAIN PROGRAM ===
</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="c1"># Load public key
</span>    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">public.pem</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">rb</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">public_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">.</span><span class="nf">import_key</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">())</span>

    <span class="c1"># Load encrypted file
</span>    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">encrypted</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">rb</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">public_key</span><span class="p">.</span><span class="n">n</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">public_key</span><span class="p">.</span><span class="n">e</span>

    <span class="c1"># Factor n (rough guess)
</span>    <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="nf">find_factor_1</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># Decrypt with small p and q
</span>    <span class="n">ct_2</span> <span class="o">=</span> <span class="nf">bytes_to_long</span><span class="p">(</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">ct</span><span class="p">))</span>

    <span class="c1"># Build candidate list near q
</span>    <span class="n">n_candidate</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span> <span class="o">-</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">)]</span>

    <span class="c1"># Try root extraction to find 512-bit base
</span>    <span class="n">to_pr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
        <span class="n">n_pr</span> <span class="o">=</span> <span class="nf">iroot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">n_pr</span><span class="p">.</span><span class="nf">bit_length</span><span class="p">()</span> <span class="o">==</span> <span class="mi">512</span><span class="p">:</span>
            <span class="n">to_pr</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">n_pr</span><span class="p">)</span>

    <span class="n">prim</span> <span class="o">=</span> <span class="n">to_pr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sav</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Start prime search
</span>    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="nf">isPrime</span><span class="p">(</span><span class="n">prim</span><span class="p">):</span>
            <span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">n_candidate</span><span class="p">:</span>
                <span class="k">if</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">prim</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">prim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sav</span><span class="p">:</span>
                        <span class="n">sav</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">prim</span><span class="p">)</span>
                        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] Found: </span><span class="si">{</span><span class="n">prim</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                    <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">break</span>
            <span class="n">prim</span> <span class="o">=</span> <span class="nf">prevprime</span><span class="p">(</span><span class="nf">prevprime</span><span class="p">(</span><span class="n">prim</span><span class="p">))</span> <span class="k">if</span> <span class="n">found</span> <span class="k">else</span> <span class="nf">prevprime</span><span class="p">(</span><span class="n">prim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prim</span> <span class="o">=</span> <span class="nf">prevprime</span><span class="p">(</span><span class="n">prim</span><span class="p">)</span>

    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Saved primes:</span><span class="sh">"</span><span class="p">,</span> <span class="n">sav</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Last checked prime:</span><span class="sh">"</span><span class="p">,</span> <span class="n">prim</span><span class="p">)</span>

    <span class="c1"># Generate RSA params using last saved prime
</span>    <span class="n">f_pr</span> <span class="o">=</span> <span class="n">sav</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nf">generate_large_prime_product</span><span class="p">(</span><span class="n">f_pr</span><span class="p">,</span> <span class="n">n_candidate</span><span class="p">)</span>

    <span class="c1"># Decrypt the actual flag
</span>    <span class="k">if</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">d</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="nf">long_to_bytes</span><span class="p">(</span><span class="nf">pow</span><span class="p">(</span><span class="n">ct_2</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">.</span><span class="nf">decode</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Failed to generate valid RSA parameters.</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<h4 id="-conclusion"><span class="me-2">‚úÖ Conclusion</span><a href="#-conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>This encryption mechanism is flawed due to:</p>

<ul>
  <li>Use of many <strong>closely spaced primes</strong> to generate a large modulus.</li>
  <li>Use of a <strong>predictable updated prime</strong> via <code class="language-plaintext highlighter-rouge">nextprime(n)</code>.</li>
  <li>Use of a <strong>weak 16-bit prime</strong> for RSA key generation.</li>
</ul>

<p>These flaws break RSA‚Äôs security assumptions and allow full decryption of the encrypted flag.</p>

<hr />

<ul>
  <li><strong>Flag</strong>: <code class="language-plaintext highlighter-rouge">Meta4Sec{l0r3m_1p5um_d0l0r_517_4m37_de6e5}</code></li>
</ul>

<hr />

<hr />

<blockquote>
  <p><em>‚ÄúCapture The Flag is not just a game. It‚Äôs a journey to mastering cybersecurity.‚Äù</em><br />
#HappyHacking üîê</p>
</blockquote>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/national-event/">National Event</a>,
          <a href="/categories/meta4sec-2025/">Meta4Sec 2025</a>,
          <a href="/categories/ctf/">ctf</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/crypto/"
            class="post-tag no-text-decoration"
          >crypto</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Meta4Sec%202025%E2%80%93%20Crypto%20-%20r's&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FMeta4Sec-2025%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Meta4Sec%202025%E2%80%93%20Crypto%20-%20r's&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FMeta4Sec-2025%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FMeta4Sec-2025%2F&text=Meta4Sec%202025%E2%80%93%20Crypto%20-%20r's" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/pwnable-2025/">Pwnable 2025</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Meta4Sec-2025/">Meta4Sec 2025‚Äì Crypto</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/UIUCTF-2025/">UIUCTF 2025‚Äì CTF Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ctf/">Getting Started with Capture The Flag (CTF) in Cybersecurity</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/hello/">Hello World</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/crypto/">crypto</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctftime/">ctftime</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/beginner/">beginner</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">ctf</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cybersecurity/">cybersecurity</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hacking/">hacking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/intro/">intro</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pwn/">pwn</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/reversing/">reversing</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/UIUCTF-2025/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1753722000"
  data-df="ll"
  
>
  Jul 29, 2025
</time>

              <h4 class="pt-0 my-2">UIUCTF 2025‚Äì CTF Writeup</h4>
              <div class="text-muted">
                <p>UIUCTF 2025‚Äì CTF Writeup     Writeup from the UIUCTF 2025 CTF event.     üîê Crypto  üîπ the_shortest_crypto_chal    Description: I‚Äôve designed the shortest crypto challenge - can you find the flag?   ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/ctf/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1658559600"
  data-df="ll"
  
>
  Jul 23, 2022
</time>

              <h4 class="pt-0 my-2">Getting Started with Capture The Flag (CTF) in Cybersecurity</h4>
              <div class="text-muted">
                <p>What is CTF?  Capture The Flag (CTF) is a cybersecurity competition where participants solve challenges to find hidden strings called ‚Äúflags‚Äù (e.g., CTF{you_found_me}). It is a fun and educational ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/UIUCTF-2025/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>UIUCTF 2025‚Äì CTF Writeup</p>
    </a>
  

  
    <a
      href="/posts/pwnable-2025/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Pwnable 2025</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>¬©
    <time>2025</time>

    
      <a href="https://twitter.com/rafidghanim">rafidghanim</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/crypto/">crypto</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctftime/">ctftime</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/beginner/">beginner</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">ctf</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cybersecurity/">cybersecurity</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hacking/">hacking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/intro/">intro</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pwn/">pwn</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/reversing/">reversing</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

